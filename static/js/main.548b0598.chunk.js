(window.webpackJsonpcsv_detective_api=window.webpackJsonpcsv_detective_api||[]).push([[0],{35:function(e,t,a){e.exports=a(64)},40:function(e,t,a){},41:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(13),c=a.n(r),o=(a(40),a(26)),s=a(33),i=a(27),u=a(12),m=a(14),d=a(34),h=(a(41),a(9)),E=a.n(h),p=a(3),f=a.n(p),g=a(30),v=a.n(g),b=a(7),w=a.n(b),_=a(31),y=a.n(_),C=a(16),k=a.n(C),D=a(15),S=a.n(D),O=a(28),j=a.n(O),R=(a(42),a(32)),P=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).onDrop=function(e){var t=new FormData;t.append("resource_csv",e[0]),a.state.formData.resource_id=e[0].name,a.setState({isLoading:!0});var n=a.url;fetch(n,{method:"POST",body:t}).then(function(e){return e.json()}).then(function(e){return a.setState({result:e,isLoading:!1})}).catch(console.log)},a.handleChange=function(e){var t=e.target.value,n=e.target.name,l=a.state.formData;l[n]=t,a.setState({formData:l})},a.updateOpenAbout=function(){a.setState({openAbout:!a.state.openAbout})},a.updateOpenPerf=function(){a.setState({openPerf:!a.state.openPerf})},a.handleCSVResponse=function(e,t){return t in e?Object.entries(e[t]).map(function(e,t){return l.a.createElement("tr",{key:t},l.a.createElement("td",null,e[0]),l.a.createElement("td",null,e[1]))}):null},a.getReferenceDatasets=function(e){var t=e.reference_matched_datasets.reference_datasets,a=e.reference_matched_datasets.matched_datasets;return Object.entries(a).map(function(e){var a=e[0],n=e[1],r=n.join(", "),c=1===n.length?"type":"types",o=t[a];return l.a.createElement("p",null,"The column ",c," ",l.a.createElement("b",null,r)," could be referenced by the dataset ",l.a.createElement("b",null,l.a.createElement("a",{href:o.url},o.name)),".")})},a.handlePredictClick=function(e){var t=a.state.formData;a.setState({isLoading:!0}),t.resource_id=""!==t.resource_id?t.resource_id:"1f0ebe13-e1f3-4adb-833a-dfc1ce8020fa";var n=a.url+"?resource_id=".concat(t.resource_id);console.log(n),fetch(n,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET"}).then(function(e){return e.json()}).then(function(e){return a.setState({result:e,isLoading:!1})}).catch(console.log),console.log(a.state.result)},a.state={isLoading:!1,formData:{resource_id:""},openAbout:!1,openPerf:!1,result:""};var n="https://api.csvdetective.etalab.studio/csv_detective/";return a.url="",a.url=n,a.handleChange=a.handleChange.bind(Object(u.a)(a)),a.handlePredictClick=a.handlePredictClick.bind(Object(u.a)(a)),a}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){document.title="CSV Detective API"}}]),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.isLoading,a=this.state.formData,n=this.state.result,r=this.state.openAbout,c=this.state.openPerf;return l.a.createElement(v.a,null,l.a.createElement("div",{className:"title"},l.a.createElement("h5",null,"CSV Detective API",l.a.createElement("sup",null,l.a.createElement("font",{size:"1"},"BETA"))," (Updated 2019-08-21)")),l.a.createElement("div",{className:"input_content"},l.a.createElement(E.a,null,l.a.createElement(E.a.Row,null,l.a.createElement(E.a.Group,{as:f.a},l.a.createElement(E.a.Label,null,"Enter a ",l.a.createElement("a",{href:"https://www.data.gouv.fr",target:"_blank",rel:"noopener noreferrer"},"data.gouv.fr")," CSV resource ID:"),l.a.createElement(E.a.Control,{type:"text",placeholder:"e.g., 1f0ebe13-e1f3-4adb-833a-dfc1ce8020fa",name:"resource_id",value:a.resource_id,onChange:this.handleChange}))),l.a.createElement(E.a.Row,null,l.a.createElement(E.a.Group,{as:f.a},l.a.createElement(y.a,{block:!0,variant:"success",disabled:t,onClick:t?null:this.handlePredictClick},t?"Making analysis":"Submit"))),l.a.createElement(E.a.Row,null,l.a.createElement(E.a.Group,{as:f.a},l.a.createElement(R.a,{onDrop:this.onDrop,accept:"text/csv",maxSize:5242880},function(e){var t=e.getRootProps,a=e.getInputProps,n=e.isDragActive,r=e.isDragReject,c=e.rejectedFiles,o=c.length>0&&c[0].size>5242880;return l.a.createElement("div",t(),l.a.createElement("input",a()),!n&&l.a.createElement("div",null,"Or upload a CSV by clicking or dropping it ",l.a.createElement("font",{color:"#0000EE"},"here")," (max 5mb)"),n&&!r&&"Drop it like it's hot!",r&&"File type not accepted, sorry!",o&&l.a.createElement("div",{className:"text-danger mt-2"},"File is too large."))}))),l.a.createElement(E.a.Row,null))),function(){if(""!==n&&0!==Object.keys(n.metadata).length)return l.a.createElement("div",{className:"results_content"},l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h3",null,"Metadata"))),l.a.createElement(w.a,null,function(){if(""!==n&&0!==Object.keys(n.metadata).length)return l.a.createElement(f.a,null,l.a.createElement(j.a,{src:n.metadata,collapsed:1,name:!1,displayDataTypes:!1}))}()))}(),function(){if(""!==n)return l.a.createElement("div",{className:"results_content"},l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h3",null,"Identified Columns (Rule Based)"))),l.a.createElement(w.a,null,l.a.createElement(f.a,null,""===n?null:l.a.createElement(S.a,{hover:!0,size:"sm"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Column Name"),l.a.createElement("th",null,"Type Detected"))),l.a.createElement("tbody",null,e.handleCSVResponse(n,"columns_rb"))))))}(),function(){if(""!==n&&0!==Object.keys(n.columns_ml).length)return l.a.createElement("div",{className:"results_content"},l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h3",null,"Identified Columns (ML Based)"))),l.a.createElement(w.a,null,l.a.createElement(f.a,null,""===n?null:l.a.createElement(S.a,{hover:!0,size:"sm"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Column Name"),l.a.createElement("th",null,"Type Detected"))),l.a.createElement("tbody",null,e.handleCSVResponse(n,"columns_ml"))))))}(),function(){if(""!==n)return l.a.createElement("div",{className:"results_content"},l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h3",null,"Reference Datasets"))),l.a.createElement(w.a,null,0!==Object.keys(n.reference_matched_datasets.matched_datasets).length?l.a.createElement(f.a,null,e.getReferenceDatasets(n)):l.a.createElement(f.a,null,"No reference datasets where found for your dataset \xaf\\_(\u30c4)_/\xaf")))}(),l.a.createElement("div",{className:"description_content"},l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h3",{onClick:this.updateOpenAbout},"About"))),l.a.createElement(k.a,{in:r},l.a.createElement("div",null,l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h5",null,"What?"),l.a.createElement("a",{href:"https://github.com/etalab/csv_detective"},"CSV Detective")," is a tool that gives you information about a CSV, such as its encoding and separator, as well as the type of columns contained inside: whether there are columns containing a ",l.a.createElement("i",null,"SIRET")," or a ",l.a.createElement("i",null,"SIREN")," number, a postal code, a department or a commune name, a geographic position, etc.",l.a.createElement("p",null,"This UI builds on CSV Detective. We improved it, APIfied it, and through this interface, you can get a glimpse of how it works. Also, we added a machine learning model as an alternative  (this is work in progress)."))),l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h5",null,"Why?"),"This tool was developed  with ",l.a.createElement("a",{href:"https://www.data.gouv.fr",target:"_blank",rel:"noopener noreferrer"},"data.gouv.fr")," (DGF) in mind. One of the main tasks of DGF is being a repository of open datasets. These datasets are often contained within CSV files. Knowing what is inside this large collection of CSVs can be useful for several tasks:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("b",null,"Enrich")," the results of DGF ",l.a.createElement("b",null,"search engine")," with the contents of the CSVs."),l.a.createElement("li",null,l.a.createElement("b",null,"Link datasets together")," according to their values."),l.a.createElement("li",null,l.a.createElement("b",null,"Link datasets")," with well-maintained, trustable ",l.a.createElement("b",null,"reference datasets"),"."),l.a.createElement("li",null,l.a.createElement("b",null,"Group datasets together")," according to their general topic.")))),l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h5",null,"How?"),"The UI has two modes of functioning: you can enter a DGF resource ID and click the button below   or you can load a CSV file by clicking in the corresponding area. The process in both cases will start automatically. Behind the scenes, CSV Detective has two strategies to detect a column type:",l.a.createElement("ol",null,l.a.createElement("li",null,l.a.createElement("b",null,"Rules + References"),": using regular expressions and also comparing the values with reference data (e.g., if the value ",l.a.createElement("i",null,"69007")," appears in a list of postal codes, then it is a postal code."),l.a.createElement("li",null,l.a.createElement("b",null,"Supervised Learning (In progress)"),": manually tagging columnt types and then determining simple features coupled to the content of the cells themselves to train classification algorithms.")))),l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h5",null,"Who?"),"Etalab's Data Science, Datagouv, and Open Data teams are working on this. The code lives ",l.a.createElement("a",{href:"https://github.com/psorianom/csv_detective_api",target:"_blank",rel:"noopener noreferrer"},"here")," for now."))))),l.a.createElement("div",{className:"performance_content"},l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("h3",{onClick:this.updateOpenPerf},"Current Performance"))),l.a.createElement(k.a,{in:c},l.a.createElement("div",null,l.a.createElement(w.a,null,l.a.createElement(f.a,null,l.a.createElement("p",null,"Rule Based"),l.a.createElement("img",{src:"https://img.shields.io/badge/F--score-84.1-green",alt:"F1-score=84.1"})),l.a.createElement(f.a,null,l.a.createElement("p",null,"Machine Learning Based"),l.a.createElement("img",{src:"https://img.shields.io/badge/F--score-87.1-green",alt:"F1-score=87.1"})))))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[35,1,2]]]);
//# sourceMappingURL=main.548b0598.chunk.js.map